## **상품 도메인 개발**

![image](https://user-images.githubusercontent.com/79301439/165893006-5c12314c-070d-48a6-b849-0cf6afdfbaf9.png)

![image](https://user-images.githubusercontent.com/79301439/165892943-1eb8dbdb-f3f5-4fec-a0c2-08146ab3cf9a.png)

***
  * 상품 엔티티 개발(비즈니스 로직 추가)
    
    ![image](https://user-images.githubusercontent.com/79301439/165893230-e376e395-890c-4e55-a2cd-3da04eeb3f7c.png)
    
    ```java
    package jpabook.jpashop.domain.item;

    import jpabook.jpashop.domain.Category;
    import jpabook.jpashop.exception.NotEnoughStockException;
    import lombok.Getter;
    import lombok.Setter;

    import javax.persistence.*;
    import java.util.ArrayList;
    import java.util.List;

    @Entity
    @Inheritance(strategy = InheritanceType.SINGLE_TABLE)//상속관계 매핑은 부모클래스에 전략을 지정해야 함
    @DiscriminatorColumn(name = "dtype") //하위타입 구분자 컬럼
    @Getter @Setter
    public abstract class Item {

        @Id
        @GeneratedValue
        @Column(name = "item_id")
        private Long id;

        private String name;
        private int price;
        private int stockQuantity;

        @ManyToMany(mappedBy = "items")
        private List<Category> categories = new ArrayList<>();

        //==비즈니스 로직==//

        /**
         * stock 증가
         */
        public void addStock(int quantity) {
            this.stockQuantity += quantity;
        }

        /**
         * stock 감소
         */
        public void removeStock(int quantity) {
            int restStock = this.stockQuantity - quantity;
            if (restStock < 0) {
                throw new NotEnoughStockException("need more stock");
            }
            this.stockQuantity = restStock;
        }
    }
    ```
    
    ![image](https://user-images.githubusercontent.com/79301439/165893346-63337d85-5221-4072-972e-1e8a1e555920.png)
    
    ```java
    package jpabook.jpashop.exception;

    public class NotEnoughStockException extends RuntimeException {

        public NotEnoughStockException() {
            super();
        }

        public NotEnoughStockException(String message) {
            super(message);
        }

        public NotEnoughStockException(String message, Throwable cause) {
            super(message, cause);
        }

        public NotEnoughStockException(Throwable cause) {
            super(cause);
        }
    }
    ```
    
    ![image](https://user-images.githubusercontent.com/79301439/165893443-2a1caa95-23e9-4f86-bdce-838d73d1552c.png)
